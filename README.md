# Test Evaluator Agent

An AI-powered data extraction evaluator agent using LangGraph for property data processing.

## Features

- Multi-agent conversation system for data extraction validation
- Schema validation using JSON Schema
- CLI validation integration
- Address matching with fuzzy logic
- Retry mechanism with configurable limits
- IPFS schema fetching and caching

## Installation

You can run this tool directly using `uvx`:

```bash
uvx --from git+https://github.com/elephant-xyz/AI-Agent test-evaluator-agent
```
you can run the tool to use the county base script using `--transform` :

```bash
uvx --from git+https://github.com/elephant-xyz/AI-Agent test-evaluator-agent --transform
````
## Usage

The agent requires specific directory structure and environment variables:


### pre-requisites
```
./seed.csv  # Seed CSV file for initial data
./input/  # properties input file to be processed, either json or html format
./upload-results.csv # csv generated from Minting Seed data group, it contains all the Property CIDs.
```

seed.csv format
```csv
parcel_id,address,method,headers,url,multiValueQueryString,body,json,source_identifier,county
154527L4000030160,"680 BELL BOULEVARD SOUTH, LEHIGH ACRES, FL 33974",GET,,https://www.leepa.org/Display/Displayparcel.aspx,{"folioID":["10635900"]},,,10635900,Lee
174423C1039390070,"307 SOUTHWEST 31ST PLACE, CAPE CORAL, FL 33991",GET,,https://www.leepa.org/Display/Displayparcel.aspx,{"folioID":["10635899"]},,,10635899,Le
```


### Agent output directory structure
```
./schemas/        # JSON schemas for validation
./data/          # Intermediate extracted data
./scripts/       # all scripts that are generated by AI-Agent
./submit/        # containes the final output that will be submitted to the CLI Validator
```

### Environment Variables
- `MODEL_NAME`: AI model to use (default: gpt-4.1)
- `TEMPERATURE`: Model temperature (default: 0)

### Running the Agent

```bash
# Set environment variables
export MODEL_NAME=gpt-4.1
export TEMPERATURE=0
export OPENAI_API_KEY=your_openai_api_key_here

# Run the agent
test-evaluator-agent
```

## How It Works

1. **Owner Extraction Phase**: The agent generates extraction scripts based on input files and schemas and analyze the owner data to determine whether it is a valid person or company.
2. **Address Matching Phase**: Generator matches addresses with candidates, CLI Validator checks final output
3. **Utility/Structer/layout extraction Phase** Generator extract utility, structure and layout information.
4 **Data Extraction and validation Phase**: Generator creates extraction scripts, Schema and Data Evaluators validate output


## Development

This package is designed to be run as a standalone tool with all dependencies managed automatically.

## NOTE: in case of running the generated scripts by AI agent directly without using the AI agent, you need to run prepare_to_submit.py script to build relationships and have data ready for submission

## Running Consensus diff tool:
```
   python3 consensus_diff.py hash1 hash2 hash3
```

# Seeding Process

## Overview

The seeding process transforms property data into blockchain-verified assets through a structured workflow. The Foundation team provides initial data on GitHub, and developers complete the seeding process by transforming, validating, storing, and minting using the Elephant CLI.

## Seed Group Architecture

### Core Components

The **Seed Group** serves as the foundational structure consisting of four essential classes:

#### 1. Group Object
- Acts as the root of the Merkle document
- Provides the top-level container for all related data
- Gets hashed and referenced in the smart contract
- Forms the Merkle root for data integrity verification

#### 2. Relationship
- Defines connections and links between objects
- Establishes data relationships within the Seed Group
- Enables proper data association and referencing

#### 3. Property Seed
- Contains information needed to retrieve property details
- Interfaces with county systems via HTTP requests
- Uses parcel ID for property identification
- Enables access to official county records

#### 4. Unnormalized Address
- Raw address input as provided by data sources
- May not be normalized or geocoded initially
- Identifies property location for mapping services
- Compatible with services like Google Maps for location verification

## Foundation Data Provision

### GitHub Data Repository

The Foundation team provides initial property data through GitHub repositories, organized by county:

**Example**: [Palm Beach County Data](https://github.com/elephant-xyz/AI-Agent/tree/main/counties/palm%20beach)

### Data Structure
- County-organized folders containing property information
- Certified county data links and references
- Raw property data ready for transformation
- Documentation and metadata for each property

## Seeding Workflow

Developers complete the seeding process using the **[Elephant CLI](https://github.com/elephant-xyz/elephant-cli)** tool for all operations.

### Step-by-Step Process

```mermaid
graph TD
    A[Foundation GitHub Data] --> B[Transform to Lexicon Schema]
    B --> C[Validate with Elephant CLI]
    C --> D[Push to IPFS via CLI]
    D --> E[Mint via CLI]
    E --> F[Check Contract Consensus]
    F --> G[Verify Token & vMahout Issuance]
    G --> H[Complete Seed]
```

#### Step 1: Access Foundation Data
- Navigate to the appropriate county folder on GitHub
- Example: [Palm Beach County](https://github.com/elephant-xyz/AI-Agent/tree/main/counties/palm%20beach)
- Download or clone the repository data
- Review property information and structure

#### Step 2: Transform to Lexicon Schema
- Convert Foundation data to **[Lexicon Schema](https://lexicon.elephant.xyz/)** format
- Ensure data structure compatibility with blockchain requirements
- Follow schema specifications for proper formatting
- Prepare data for validation step

#### Step 3: Validate Using Elephant CLI
- Install and configure **[Elephant CLI](https://github.com/elephant-xyz/elephant-cli)**
- Run validation commands to verify data integrity
- Ensure schema compliance and structure correctness
- Fix any validation errors before proceeding

#### Step 4: Push to IPFS
- Use Elephant CLI to upload validated data to IPFS
- Generate IPFS content hashes for decentralized storage
- Verify successful storage and accessibility
- Record IPFS hash for minting process

#### Step 5: Mint the Seed
- Execute minting command via Elephant CLI
- Generate and submit Merkle hash to smart contract
- Complete blockchain registration process
- Initiate consensus verification process

#### Step 6: Verify Contract Consensus & Token Issuance
- Check smart contract for consensus confirmation
- Verify that consensus has been reached by network validators
- Confirm token issuance has occurred
- Verify vMahout token distribution
- Validate final seed completion status



